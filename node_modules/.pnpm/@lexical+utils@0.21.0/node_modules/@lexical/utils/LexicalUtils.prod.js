/**
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 */

'use strict';var g=require("lexical"),v=require("@lexical/selection"),C;function D(a){let b=new URLSearchParams;b.append("code",a);for(let c=1;c<arguments.length;c++)b.append("v",arguments[c]);throw Error(`Minified Lexical error #${a}; visit https://lexical.dev/docs/error?${b} for the full message or `+"use the non-minified dev environment for full errors and additional helpful warnings.");}C=D&&D.__esModule&&Object.prototype.hasOwnProperty.call(D,"default")?D["default"]:D;
let E="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,F=E&&"documentMode"in document?document.documentMode:null,G=E&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),H=E&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),I=E&&"InputEvent"in window&&!F?"getTargetRanges"in new window.InputEvent("input"):!1,J=E&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),K=E&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,
L=E&&/Android/.test(navigator.userAgent),M=E&&/^(?=.*Chrome).*/i.test(navigator.userAgent),N=E&&L&&M;function O(...a){let b=[];for(let c of a)if(c&&"string"===typeof c)for(let [d]of c.matchAll(/\S+/g))b.push(d);return b}function P(...a){return()=>{for(let b=a.length-1;0<=b;b--)a[b]();a.length=0}}let Q={attributes:!0,characterData:!0,childList:!0,subtree:!0};
function R(a,b,c){function d(){null===h&&C(182);null===k&&C(183);let {left:r,top:z}=k.getBoundingClientRect(),y=v.createRectsFromDOMRange(a,b);q.isConnected||k.insertBefore(q,k.firstChild);let m=!1;for(let w=0;w<y.length;w++){var x=y[w];let t=l[w]||document.createElement("div"),A=t.style;"absolute"!==A.position&&(A.position="absolute",m=!0);var p=`${x.left-r}px`;A.left!==p&&(A.left=p,m=!0);p=`${x.top-z}px`;A.top!==p&&(t.style.top=p,m=!0);p=`${x.width}px`;A.width!==p&&(t.style.width=p,m=!0);x=`${x.height}px`;
A.height!==x&&(t.style.height=x,m=!0);t.parentNode!==q&&(q.append(t),m=!0);l[w]=t}for(;l.length>y.length;)l.pop();m&&c(l)}function e(){h=k=null;null!==n&&n.disconnect();n=null;q.remove();for(let r of l)r.remove();l=[]}function f(){let r=a.getRootElement();if(null===r)return e();let z=r.parentElement;if(null===z||!g.isHTMLElement(z))return e();e();h=r;k=z;n=new MutationObserver(y=>{let m=a.getRootElement(),x=m&&m.parentElement;if(m!==h||x!==k)return f();for(let p of y)if(!q.contains(p.target))return d()});
n.observe(z,Q);d()}let h=null,k=null,n=null,l=[],q=document.createElement("div");q.style.position="relative";let B=a.registerRootListener(f);return()=>{B();e()}}
function S(a,b){function c(n){n.read(()=>{var l=g.$getSelection();if(g.$isRangeSelection(l)){var {anchor:q,focus:B}=l;l=q.getNode();var r=l.getKey(),z=q.offset,y=B.getNode(),m=y.getKey(),x=B.offset,p=a.getElementByKey(r),w=a.getElementByKey(m);r=null===d||null===p||z!==e||r!==d.getKey()||l!==d&&(!g.$isTextNode(d)||l.updateDOM(d,p,a._config));m=null===f||null===w||x!==h||m!==f.getKey()||y!==f&&(!g.$isTextNode(f)||y.updateDOM(f,w,a._config));if(r||m){p=a.getElementByKey(q.getNode().getKey());var t=
a.getElementByKey(B.getNode().getKey());if(null!==p&&null!==t){m=document.createRange();B.isBefore(q)?(w=t,r=B.offset,t=q.offset):(w=p,r=q.offset,p=t,t=B.offset);let A=g.getDOMTextNode(w),aa=g.getDOMTextNode(p);m.setStart(A||w,r);m.setEnd(aa||p,t);k();k=R(a,m,u=>{if(void 0===b)for(let ba of u)u=ba.style,"Highlight"!==u.background&&(u.background="Highlight"),"HighlightText"!==u.color&&(u.color="HighlightText"),"-1.5px"!==u.marginTop&&(u.marginTop="-1.5px"),"4px"!==u.paddingTop&&(u.paddingTop="4px"),
"0px"!==u.paddingBottom&&(u.paddingBottom="0px");else b(u)})}}d=l;e=z;f=y;h=x}else h=f=e=d=null,k(),k=()=>{}})}let d=null,e=null,f=null,h=null,k=()=>{};c(a.getEditorState());return P(a.registerUpdateListener(({editorState:n})=>c(n)),k,()=>{k()})}let ca=E&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!M;function T(a,b){for(let c of b)if(a.type.startsWith(c))return!0;return!1}let U={done:!0,value:void 0};
function V(a,b){a=(a||g.$getRoot()).getLatest();let c=W(a),d=a,e=c,f=!0,h={next(){if(null===d)return U;if(f)return f=!1,{done:!1,value:{depth:e,node:d}};if(d===b)return U;if(g.$isElementNode(d)&&0<d.getChildrenSize())d=d.getFirstChild(),e++;else{let k;[d,k]=X(d)||[null,0];e+=k;null==b&&e<=c&&(d=null)}return null===d?U:{done:!1,value:{depth:e,node:d}}},[Symbol.iterator](){return h}};return h}
function X(a){let b=null,c=0;for(;null===b&&null!==a;)b=a.getNextSibling(),null===b?(a=a.getParent(),c--):a=b;return null===a?null:[a,c]}function W(a){let b=0;for(;null!==(a=a.getParent());)b++;return b}let Y=(a,b)=>{for(;a!==g.$getRoot()&&null!=a;){if(b(a))return a;a=a.getParent()}return null},Z=H||!E?!1:void 0;exports.$splitNode=g.$splitNode;exports.isBlockDomNode=g.isBlockDomNode;exports.isHTMLAnchorElement=g.isHTMLAnchorElement;exports.isHTMLElement=g.isHTMLElement;exports.isInlineDomNode=g.isInlineDomNode;
exports.$dfs=function(a,b){return Array.from(V(a,b))};exports.$dfsIterator=V;exports.$filter=function(a,b){let c=[];for(let d=0;d<a.length;d++){let e=b(a[d]);null!==e&&c.push(e)}return c};exports.$findMatchingParent=Y;exports.$getDepth=W;exports.$getNearestBlockElementAncestorOrThrow=function(a){let b=Y(a,c=>g.$isElementNode(c)&&!c.isInline());g.$isElementNode(b)||C(4,a.__key);return b};exports.$getNearestNodeOfType=function(a,b){for(;null!=a;){if(a instanceof b)return a;a=a.getParent()}return null};
exports.$getNextRightPreorderNode=function(a){if(g.$isElementNode(a)&&0<a.getChildrenSize())a=a.getLastChild();else{let b=null;for(;null===b&&null!==a;)b=a.getPreviousSibling(),a=null===b?a.getParent():b}return a};exports.$getNextSiblingOrParentSibling=X;exports.$insertFirst=function(a,b){let c=a.getFirstChild();null!==c?c.insertBefore(b):a.append(b)};
exports.$insertNodeToNearestRoot=function(a){var b=g.$getSelection()||g.$getPreviousSelection();if(g.$isRangeSelection(b)){var {focus:c}=b;b=c.getNode();c=c.offset;if(g.$isRootOrShadowRoot(b))c=b.getChildAtIndex(c),null==c?b.append(a):c.insertBefore(a),a.selectNext();else{let d,e;g.$isTextNode(b)?(d=b.getParentOrThrow(),e=b.getIndexWithinParent(),0<c&&(e+=1,b.splitText(c))):(d=b,e=c);[,b]=g.$splitNode(d,e);b.insertBefore(a);b.selectStart()}}else null!=b?(b=b.getNodes(),b[b.length-1].getTopLevelElementOrThrow().insertAfter(a)):
g.$getRoot().append(a),b=g.$createParagraphNode(),a.insertAfter(b),b.select();return a.getLatest()};exports.$isEditorIsNestedEditor=function(a){return null!==a._parentEditor};exports.$restoreEditorState=function(a,b){let c=new Map,d=a._pendingEditorState;for(let [e,f]of b._nodeMap)c.set(e,g.$cloneWithProperties(f));d&&(d._nodeMap=c);a._dirtyType=2;a=b._selection;g.$setSelection(null===a?null:a.clone())};exports.$wrapNodeInElement=function(a,b){b=b();a.replace(b);b.append(a);return b};
exports.CAN_USE_BEFORE_INPUT=I;exports.CAN_USE_DOM=E;exports.IS_ANDROID=L;exports.IS_ANDROID_CHROME=N;exports.IS_APPLE=G;exports.IS_APPLE_WEBKIT=ca;exports.IS_CHROME=M;exports.IS_FIREFOX=H;exports.IS_IOS=K;exports.IS_SAFARI=J;exports.addClassNamesToElement=function(a,...b){b=O(...b);0<b.length&&a.classList.add(...b)};
exports.calculateZoomLevel=function(a){let b=1;if(void 0===Z){let c=document.createElement("div");c.style.cssText="position: absolute; opacity: 0; width: 100px; left: -1000px;";document.body.appendChild(c);let d=c.getBoundingClientRect();c.style.setProperty("zoom","2");Z=c.getBoundingClientRect().width===d.width;document.body.removeChild(c)}if(Z)for(;a;)b*=Number(window.getComputedStyle(a).getPropertyValue("zoom")),a=a.parentElement;return b};exports.isMimeType=T;exports.markSelection=S;
exports.mediaFileReader=function(a,b){let c=a[Symbol.iterator]();return new Promise((d,e)=>{let f=[],h=()=>{const {done:k,value:n}=c.next();if(k)return d(f);const l=new FileReader;l.addEventListener("error",e);l.addEventListener("load",()=>{const q=l.result;"string"===typeof q&&f.push({file:n,result:q});h()});T(n,b)?l.readAsDataURL(n):h()};h()})};exports.mergeRegister=P;exports.objectKlassEquals=function(a,b){return null!==a?Object.getPrototypeOf(a).constructor.name===b.name:!1};
exports.positionNodeOnRange=R;
exports.registerNestedElementResolver=function(a,b,c,d){return a.registerNodeTransform(b,e=>{a:{var f=e.getChildren();for(var h=0;h<f.length;h++)if(f[h]instanceof b){f=null;break a}for(f=e;null!==f;)if(h=f,f=f.getParent(),f instanceof b){f={child:h,parent:f};break a}f=null}if(null!==f){const {child:k,parent:n}=f;if(k.is(e)){d(n,e);e=k.getNextSiblings();f=e.length;n.insertAfter(k);if(0!==f){h=c(n);k.insertAfter(h);for(let l=0;l<f;l++)h.append(e[l])}n.canBeEmpty()||0!==n.getChildrenSize()||n.remove()}}})};
exports.removeClassNamesFromElement=function(a,...b){b=O(...b);0<b.length&&a.classList.remove(...b)};exports.selectionAlwaysOnDisplay=function(a){let b=null,c=()=>{var d=getSelection();d=d&&d.anchorNode;const e=a.getRootElement();null!==d&&null!==e&&e.contains(d)?null!==b&&(b(),b=null):null===b&&(b=S(a))};document.addEventListener("selectionchange",c);return()=>{null!==b&&b();document.removeEventListener("selectionchange",c)}}
